knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)
include_graphics('lotr_goodbye.jpg')
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)
packages<-c("tidyverse","knitr")
package.check <- lapply(
packages,
FUN = function(x) {
if (!require(x, character.only = TRUE)) {
install.packages(x, dependencies = TRUE)
library(x, character.only = TRUE)
}
}
)
include_graphics('lotr_goodbye.jpg')
knitr::opts_chunk$set(echo = FALSE)
packages<-c("tidyverse","knitr","ggrepel","forcats",
"scales","ggmap")
package.check <- lapply(
packages,
FUN = function(x) {
if (!require(x, character.only = TRUE)) {
install.packages(x, dependencies = TRUE)
library(x, character.only = TRUE)
}
}
)
year<-c(1950:2019)
hom_rate<-c(4.6, 4.4, 4.6, 4.5, 4.2, 4.1, 4.1, 4.0, 4.8, 4.9, 5.1, 4.8, 4.6,
4.6, 4.9, 5.1, 5.6, 6.2, 6.9, 7.3, 7.9, 8.6, 9.0, 9.4, 9.8, 9.6,
8.7, 8.8, 9.0, 9.8, 10.2, 9.8, 9.1, 8.3, 7.9, 8.0, 8.5, 8.3, 8.4,
8.7, 9.4, 9.8, 9.3, 9.5, 9.0, 8.2, 7.4, 6.8, 6.3, 5.7, 5.5, 5.6,
5.6, 5.7, 5.5, 5.6, 5.8, 5.7, 5.4, 5 ,4.8, 4.7, 4.7, 4.5, 4.4, 4.9,
5.4,5.3,5,5)
ggplot(,aes(x=factor(year),y=hom_rate, group=1)) +
geom_line() +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
theme(axis.text.x=element_text(angle=45, hjust=1))
year<-c(1950:2019)
hom_rate<-c(4.6, 4.4, 4.6, 4.5, 4.2, 4.1, 4.1, 4.0, 4.8, 4.9, 5.1, 4.8, 4.6,
4.6, 4.9, 5.1, 5.6, 6.2, 6.9, 7.3, 7.9, 8.6, 9.0, 9.4, 9.8, 9.6,
8.7, 8.8, 9.0, 9.8, 10.2, 9.8, 9.1, 8.3, 7.9, 8.0, 8.5, 8.3, 8.4,
8.7, 9.4, 9.8, 9.3, 9.5, 9.0, 8.2, 7.4, 6.8, 6.3, 5.7, 5.5, 5.6,
5.6, 5.7, 5.5, 5.6, 5.8, 5.7, 5.4, 5 ,4.8, 4.7, 4.7, 4.5, 4.4, 4.9,
5.4,5.3,5,5)
ggplot(,aes(x=factor(year),y=hom_rate, group=1)) +
geom_line() +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
theme(axis.text.x=element_text(angle=45, hjust=1, size=9))
year<-c(1950:2019)
hom_rate<-c(4.6, 4.4, 4.6, 4.5, 4.2, 4.1, 4.1, 4.0, 4.8, 4.9, 5.1, 4.8, 4.6,
4.6, 4.9, 5.1, 5.6, 6.2, 6.9, 7.3, 7.9, 8.6, 9.0, 9.4, 9.8, 9.6,
8.7, 8.8, 9.0, 9.8, 10.2, 9.8, 9.1, 8.3, 7.9, 8.0, 8.5, 8.3, 8.4,
8.7, 9.4, 9.8, 9.3, 9.5, 9.0, 8.2, 7.4, 6.8, 6.3, 5.7, 5.5, 5.6,
5.6, 5.7, 5.5, 5.6, 5.8, 5.7, 5.4, 5 ,4.8, 4.7, 4.7, 4.5, 4.4, 4.9,
5.4,5.3,5,5)
ggplot(,aes(x=factor(year),y=hom_rate, group=1)) +
geom_line() +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
theme(axis.text.x=element_text(angle=45, hjust=1, size=7))
year<-c(1950:2019)
hom_rate<-c(4.6, 4.4, 4.6, 4.5, 4.2, 4.1, 4.1, 4.0, 4.8, 4.9, 5.1, 4.8, 4.6,
4.6, 4.9, 5.1, 5.6, 6.2, 6.9, 7.3, 7.9, 8.6, 9.0, 9.4, 9.8, 9.6,
8.7, 8.8, 9.0, 9.8, 10.2, 9.8, 9.1, 8.3, 7.9, 8.0, 8.5, 8.3, 8.4,
8.7, 9.4, 9.8, 9.3, 9.5, 9.0, 8.2, 7.4, 6.8, 6.3, 5.7, 5.5, 5.6,
5.6, 5.7, 5.5, 5.6, 5.8, 5.7, 5.4, 5 ,4.8, 4.7, 4.7, 4.5, 4.4, 4.9,
5.4,5.3,5,5)
ggplot(,aes(x=factor(year),y=hom_rate, group=1)) +
geom_line() +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
theme(axis.text.x=element_text(angle=45, hjust=1, size=5))
year<-c(1950:2019)
hom_rate<-c(4.6, 4.4, 4.6, 4.5, 4.2, 4.1, 4.1, 4.0, 4.8, 4.9, 5.1, 4.8, 4.6,
4.6, 4.9, 5.1, 5.6, 6.2, 6.9, 7.3, 7.9, 8.6, 9.0, 9.4, 9.8, 9.6,
8.7, 8.8, 9.0, 9.8, 10.2, 9.8, 9.1, 8.3, 7.9, 8.0, 8.5, 8.3, 8.4,
8.7, 9.4, 9.8, 9.3, 9.5, 9.0, 8.2, 7.4, 6.8, 6.3, 5.7, 5.5, 5.6,
5.6, 5.7, 5.5, 5.6, 5.8, 5.7, 5.4, 5 ,4.8, 4.7, 4.7, 4.5, 4.4, 4.9,
5.4,5.3,5,5)
ggplot(,aes(x=factor(year),y=hom_rate, group=1)) +
geom_line() +
geom_point() +
geom_smooth(data=subset(,year>1990), method="lm", se=FALSE) +
theme(axis.text.x=element_text(angle=45, hjust=1, size=10))
year<-c(1950:2019)
hom_rate<-c(4.6, 4.4, 4.6, 4.5, 4.2, 4.1, 4.1, 4.0, 4.8, 4.9, 5.1, 4.8, 4.6,
4.6, 4.9, 5.1, 5.6, 6.2, 6.9, 7.3, 7.9, 8.6, 9.0, 9.4, 9.8, 9.6,
8.7, 8.8, 9.0, 9.8, 10.2, 9.8, 9.1, 8.3, 7.9, 8.0, 8.5, 8.3, 8.4,
8.7, 9.4, 9.8, 9.3, 9.5, 9.0, 8.2, 7.4, 6.8, 6.3, 5.7, 5.5, 5.6,
5.6, 5.7, 5.5, 5.6, 5.8, 5.7, 5.4, 5 ,4.8, 4.7, 4.7, 4.5, 4.4, 4.9,
5.4,5.3,5,5)
ggplot(,aes(x=factor(year),y=hom_rate, group=1)) +
geom_line() +
geom_point() +
geom_smooth(data=subset(year,year>1990), method="lm", se=FALSE) +
theme(axis.text.x=element_text(angle=45, hjust=1, size=10))
year<-c(1950:2019)
hom_rate<-c(4.6, 4.4, 4.6, 4.5, 4.2, 4.1, 4.1, 4.0, 4.8, 4.9, 5.1, 4.8, 4.6,
4.6, 4.9, 5.1, 5.6, 6.2, 6.9, 7.3, 7.9, 8.6, 9.0, 9.4, 9.8, 9.6,
8.7, 8.8, 9.0, 9.8, 10.2, 9.8, 9.1, 8.3, 7.9, 8.0, 8.5, 8.3, 8.4,
8.7, 9.4, 9.8, 9.3, 9.5, 9.0, 8.2, 7.4, 6.8, 6.3, 5.7, 5.5, 5.6,
5.6, 5.7, 5.5, 5.6, 5.8, 5.7, 5.4, 5 ,4.8, 4.7, 4.7, 4.5, 4.4, 4.9,
5.4,5.3,5,5)
df<-data.frame(year, hom_rate)
ggplot(df,aes(x=factor(year),y=hom_rate, group=1)) +
geom_line() +
geom_point() +
geom_smooth(data=subset(df,year>1990), method="lm", se=FALSE) +
theme(axis.text.x=element_text(angle=45, hjust=1, size=10))
year<-c(1950:2019)
hom_rate<-c(4.6, 4.4, 4.6, 4.5, 4.2, 4.1, 4.1, 4.0, 4.8, 4.9, 5.1, 4.8, 4.6,
4.6, 4.9, 5.1, 5.6, 6.2, 6.9, 7.3, 7.9, 8.6, 9.0, 9.4, 9.8, 9.6,
8.7, 8.8, 9.0, 9.8, 10.2, 9.8, 9.1, 8.3, 7.9, 8.0, 8.5, 8.3, 8.4,
8.7, 9.4, 9.8, 9.3, 9.5, 9.0, 8.2, 7.4, 6.8, 6.3, 5.7, 5.5, 5.6,
5.6, 5.7, 5.5, 5.6, 5.8, 5.7, 5.4, 5 ,4.8, 4.7, 4.7, 4.5, 4.4, 4.9,
5.4,5.3,5,5)
df<-data.frame(year, hom_rate)
ggplot(df,aes(x=factor(year),y=hom_rate, group=1)) +
geom_line() +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
theme(axis.text.x=element_text(angle=45, hjust=1, size=10))
year<-c(1950:2019)
hom_rate<-c(4.6, 4.4, 4.6, 4.5, 4.2, 4.1, 4.1, 4.0, 4.8, 4.9, 5.1, 4.8, 4.6,
4.6, 4.9, 5.1, 5.6, 6.2, 6.9, 7.3, 7.9, 8.6, 9.0, 9.4, 9.8, 9.6,
8.7, 8.8, 9.0, 9.8, 10.2, 9.8, 9.1, 8.3, 7.9, 8.0, 8.5, 8.3, 8.4,
8.7, 9.4, 9.8, 9.3, 9.5, 9.0, 8.2, 7.4, 6.8, 6.3, 5.7, 5.5, 5.6,
5.6, 5.7, 5.5, 5.6, 5.8, 5.7, 5.4, 5 ,4.8, 4.7, 4.7, 4.5, 4.4, 4.9,
5.4,5.3,5,5)
ggplot(df,aes(x=factor(year),y=hom_rate, group=1)) +
geom_line() +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
geom_smooth(method='loess', se=FALSE)
theme(axis.text.x=element_text(angle=45, hjust=1, size=10))
year<-c(1950:2019)
hom_rate<-c(4.6, 4.4, 4.6, 4.5, 4.2, 4.1, 4.1, 4.0, 4.8, 4.9, 5.1, 4.8, 4.6,
4.6, 4.9, 5.1, 5.6, 6.2, 6.9, 7.3, 7.9, 8.6, 9.0, 9.4, 9.8, 9.6,
8.7, 8.8, 9.0, 9.8, 10.2, 9.8, 9.1, 8.3, 7.9, 8.0, 8.5, 8.3, 8.4,
8.7, 9.4, 9.8, 9.3, 9.5, 9.0, 8.2, 7.4, 6.8, 6.3, 5.7, 5.5, 5.6,
5.6, 5.7, 5.5, 5.6, 5.8, 5.7, 5.4, 5 ,4.8, 4.7, 4.7, 4.5, 4.4, 4.9,
5.4,5.3,5,5)
ggplot(df,aes(x=factor(year),y=hom_rate, group=1)) +
geom_line() +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
geom_smooth(method='loess', se=FALSE, color='red')
theme(axis.text.x=element_text(angle=45, hjust=1, size=10))
year<-c(1950:2019)
hom_rate<-c(4.6, 4.4, 4.6, 4.5, 4.2, 4.1, 4.1, 4.0, 4.8, 4.9, 5.1, 4.8, 4.6,
4.6, 4.9, 5.1, 5.6, 6.2, 6.9, 7.3, 7.9, 8.6, 9.0, 9.4, 9.8, 9.6,
8.7, 8.8, 9.0, 9.8, 10.2, 9.8, 9.1, 8.3, 7.9, 8.0, 8.5, 8.3, 8.4,
8.7, 9.4, 9.8, 9.3, 9.5, 9.0, 8.2, 7.4, 6.8, 6.3, 5.7, 5.5, 5.6,
5.6, 5.7, 5.5, 5.6, 5.8, 5.7, 5.4, 5 ,4.8, 4.7, 4.7, 4.5, 4.4, 4.9,
5.4,5.3,5,5)
ggplot(df,aes(x=factor(year),y=hom_rate, group=1)) +
geom_line() +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
geom_smooth(method='loess', se=FALSE, color='red', linetype='dashed')
theme(axis.text.x=element_text(angle=45, hjust=1, size=10))
year<-c(1950:2019)
hom_rate<-c(4.6, 4.4, 4.6, 4.5, 4.2, 4.1, 4.1, 4.0, 4.8, 4.9, 5.1, 4.8, 4.6,
4.6, 4.9, 5.1, 5.6, 6.2, 6.9, 7.3, 7.9, 8.6, 9.0, 9.4, 9.8, 9.6,
8.7, 8.8, 9.0, 9.8, 10.2, 9.8, 9.1, 8.3, 7.9, 8.0, 8.5, 8.3, 8.4,
8.7, 9.4, 9.8, 9.3, 9.5, 9.0, 8.2, 7.4, 6.8, 6.3, 5.7, 5.5, 5.6,
5.6, 5.7, 5.5, 5.6, 5.8, 5.7, 5.4, 5 ,4.8, 4.7, 4.7, 4.5, 4.4, 4.9,
5.4,5.3,5,5)
ggplot(df,aes(x=factor(year),y=hom_rate, group=1)) +
geom_line() +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
ylim(0, max(hom_rate))
theme(axis.text.x=element_text(angle=45, hjust=1, size=10))
year<-c(1950:2019)
hom_rate<-c(4.6, 4.4, 4.6, 4.5, 4.2, 4.1, 4.1, 4.0, 4.8, 4.9, 5.1, 4.8, 4.6,
4.6, 4.9, 5.1, 5.6, 6.2, 6.9, 7.3, 7.9, 8.6, 9.0, 9.4, 9.8, 9.6,
8.7, 8.8, 9.0, 9.8, 10.2, 9.8, 9.1, 8.3, 7.9, 8.0, 8.5, 8.3, 8.4,
8.7, 9.4, 9.8, 9.3, 9.5, 9.0, 8.2, 7.4, 6.8, 6.3, 5.7, 5.5, 5.6,
5.6, 5.7, 5.5, 5.6, 5.8, 5.7, 5.4, 5 ,4.8, 4.7, 4.7, 4.5, 4.4, 4.9,
5.4,5.3,5,5)
ggplot(df,aes(x=factor(year),y=hom_rate, group=1)) +
geom_line() +
geom_point() +
geom_smooth(method="lm", se=FALSE) +
ylim(min(hom_rate), max(hom_rate))
theme(axis.text.x=element_text(angle=45, hjust=1, size=10))
ggplot(data = us_counties, mapping = aes(x = long, y = lat,
group = group, fill = subregion)) +
geom_polygon(color = "gray90", size = 0.1) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
guides(fill = FALSE)+
theme(axis.line=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank(),
axis.title=element_blank(),
panel.background=element_blank(),
panel.border=element_blank(),
panel.grid=element_blank())
us_states <- map_data("state")
us_counties <- map_data("county")
ggplot(data = us_counties, mapping = aes(x = long, y = lat,
group = group, fill = subregion)) +
geom_polygon(color = "gray90", size = 0.1) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
guides(fill = FALSE)+
theme(axis.line=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank(),
axis.title=element_blank(),
panel.background=element_blank(),
panel.border=element_blank(),
panel.grid=element_blank())
